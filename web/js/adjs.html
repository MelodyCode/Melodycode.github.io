<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>原型链 | Melody的个人博客</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="Hello World!">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.4bd64760.js" as="script"><link rel="preload" href="/assets/js/2.cae01b08.js" as="script"><link rel="preload" href="/assets/js/20.f36be1a4.js" as="script"><link rel="prefetch" href="/assets/js/10.9d9f13fd.js"><link rel="prefetch" href="/assets/js/11.ae4f162d.js"><link rel="prefetch" href="/assets/js/12.7946ae6f.js"><link rel="prefetch" href="/assets/js/13.7cf5e4ed.js"><link rel="prefetch" href="/assets/js/14.ca2d886a.js"><link rel="prefetch" href="/assets/js/15.9194acab.js"><link rel="prefetch" href="/assets/js/16.4162c3d7.js"><link rel="prefetch" href="/assets/js/17.afdf0396.js"><link rel="prefetch" href="/assets/js/18.f6d4ecf4.js"><link rel="prefetch" href="/assets/js/19.8c45b6e4.js"><link rel="prefetch" href="/assets/js/21.951a28c7.js"><link rel="prefetch" href="/assets/js/22.b2bb296a.js"><link rel="prefetch" href="/assets/js/23.f2235999.js"><link rel="prefetch" href="/assets/js/24.2db98eea.js"><link rel="prefetch" href="/assets/js/25.e97e72ef.js"><link rel="prefetch" href="/assets/js/26.3a2f6f5b.js"><link rel="prefetch" href="/assets/js/3.93ad5e29.js"><link rel="prefetch" href="/assets/js/4.7b50080d.js"><link rel="prefetch" href="/assets/js/5.94fd6fdc.js"><link rel="prefetch" href="/assets/js/6.8bb5960a.js"><link rel="prefetch" href="/assets/js/7.199b11cc.js"><link rel="prefetch" href="/assets/js/8.b7aa8606.js"><link rel="prefetch" href="/assets/js/9.c7943dd0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Melody的个人博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/web/" class="nav-link router-link-active">
  前端
</a></div><div class="nav-item"><a href="/interview/" class="nav-link">
  面试
</a></div><div class="nav-item"><a href="/basic/" class="nav-link">
  计算机基础
</a></div><div class="nav-item"><a href="https://github.com/MelodyCode/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/web/" class="nav-link router-link-active">
  前端
</a></div><div class="nav-item"><a href="/interview/" class="nav-link">
  面试
</a></div><div class="nav-item"><a href="/basic/" class="nav-link">
  计算机基础
</a></div><div class="nav-item"><a href="https://github.com/MelodyCode/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/web/" aria-current="page" class="sidebar-link">介绍</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JavaScript</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/web/js/" aria-current="page" class="sidebar-link">目录</a></li><li><a href="/web/js/adjs.html" aria-current="page" class="active sidebar-link">JS笔记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web/js/adjs.html#原型链" class="sidebar-link">原型链</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#变量提升与函数提升" class="sidebar-link">变量提升与函数提升</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#执行上下文与执行上下文栈" class="sidebar-link">执行上下文与执行上下文栈</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#作用域与作用域链" class="sidebar-link">作用域与作用域链</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#闭包-closure" class="sidebar-link">闭包(Closure)</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#promise" class="sidebar-link">Promise</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#async和await" class="sidebar-link">async和await</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#变量类型" class="sidebar-link">变量类型：</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#变量计算-类型转换" class="sidebar-link">变量计算-类型转换</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#原型和原型链" class="sidebar-link">原型和原型链</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#作用域和闭包" class="sidebar-link">作用域和闭包</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#异步" class="sidebar-link">异步</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#异步进阶" class="sidebar-link">异步进阶：</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#js-web-api-dom" class="sidebar-link">Js-Web-API-DOM</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#js-web-api-bom" class="sidebar-link">Js-Web-API-BOM</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#js-web-api-事件" class="sidebar-link">JS-web-API-事件</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#js-web-api-ajax" class="sidebar-link">JS-web-API-ajax</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#存储" class="sidebar-link">存储</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#http面试题" class="sidebar-link">http面试题</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#资源标识" class="sidebar-link">资源标识：</a></li><li class="sidebar-sub-header"><a href="/web/js/adjs.html#运行环境" class="sidebar-link">运行环境</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node.js</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="原型链"><a href="#原型链" class="header-anchor">#</a> 原型链</h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span>
<span class="token comment">//相当于var Fn= new Function(),函数对象Fn是Function的实例</span>
<span class="token keyword">function</span> <span class="token function">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">test1</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;test1()&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">test2</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;test2()&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
fn<span class="token punctuation">.</span><span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
fn<span class="token punctuation">.</span><span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fn<span class="token punctuation">.</span><span class="token function">test3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ul><li>原型链
<ul><li>访问一个对象属性时
<ul><li>现在自身属性中查找，找到后返回</li> <li>如果没有，再沿着__proto__这条链向上查找，找到返回</li> <li>如果最终没有找到，返回undefined</li></ul></li> <li>别名： 隐式原型链</li> <li>作用： 查找对象的<em>属性（方法）</em>；ps:查找变量的话要根据作用域链</li></ul></li></ul> <h2 id="变量提升与函数提升"><a href="#变量提升与函数提升" class="header-anchor">#</a> 变量提升与函数提升</h2> <ul><li>变量声明提升
<ul><li>通过var定义（声明）的变量，在定义语句之前就可以访问到</li> <li>值：undefined</li></ul></li> <li>函数声明提升
<ul><li>通过function声明的函数在之前就可以直接调用</li> <li>值：函数定义（对象）</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//面试题</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">3</span>
functio <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
	<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">4</span>
<span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token comment">//undefined 变量提升</span>
<span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//可调用函数提升</span>
<span class="token function">fn3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//不可调用，是变量提升而不是函数提升</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">3</span>
<span class="token keyword">function</span> <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;fn2()&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token function-variable function">fn3</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;fn3()&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="执行上下文与执行上下文栈"><a href="#执行上下文与执行上下文栈" class="header-anchor">#</a> 执行上下文与执行上下文栈</h2> <ul><li>1.代码分类（位置）
<ul><li>全局代码</li> <li>函数代码</li></ul></li> <li>2.全局执行上下文
<ul><li>第一步：在执行全局代码前将window定为全局执行上下文</li> <li>第二步：对全局数据进行预处理
<ul><li>var 定义的全局变量==&gt;undefined,添加为window的属性</li> <li>function 声明的全局函数==&gt;赋值（fun),添加为window的方法</li> <li>this==&gt;赋值(window)</li></ul></li> <li>第三步：开始执行全局代码</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span>window<span class="token punctuation">.</span>a1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//undefined undefined</span>
window<span class="token punctuation">.</span><span class="token function">a2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//a2()</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//window</span>
<span class="token keyword">var</span> a1 <span class="token operator">=</span> <span class="token number">3</span>
<span class="token keyword">function</span> <span class="token function">a2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;a2()&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>3.函数执行上下文
<ul><li>第一步：在<strong>调用函数，准备执行函数体之前</strong>，创建对应的函数执行上下文对象--&gt;一个虚拟对象</li> <li>第二步：对局部数据进行预处理
<ul><li>形参变量==&gt;  赋值（实参)，添加为执行上下文的属性</li> <li>arguments==&gt; 赋值（实参列表），添加为执行上下文的属性（在函数执行之前arguments已经存在并有值）</li> <li>var定义的局部变量==&gt;undefined，添加为执行上下文的属性</li> <li>function声明的函数 ==&gt; 赋值（fun），添加为执行上下文的属性</li> <li>this ==&gt; 赋值（调用函数的对象）</li></ul></li> <li>第三步：开始执行函数体代码</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> a1 <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">a1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//undefined</span>
	<span class="token function">a3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//a3()</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//window，因为直接调用了fn(2,3)</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//伪数组</span>
    <span class="token keyword">var</span> a2 <span class="token operator">=</span> <span class="token number">3</span>
    <span class="token keyword">function</span> <span class="token function">a3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a3()'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">//调用函数，执行函数体之前，产生函数执行上下文</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li>4.执行上下文栈
（ps：栈：后进先出LIFO；队列：先进先出FIFO）
<ul><li>在全局代码执行前，JS引擎会创建一个栈来存储管理所有的执行上下文对象</li> <li>在全局执行上下文（window）确定后，将其添加到栈中（压栈）</li> <li>在函数执行上下文创建后，将其压入栈中（压栈）</li> <li>在当前函数执行完后，将栈顶的对象移除（出栈）</li> <li>当所有的代码执行完后，栈中只剩下window</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">10</span>
<span class="token keyword">var</span> <span class="token function-variable function">bar</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
	<span class="token function">foo</span><span class="token punctuation">(</span>x <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">+</span> c <span class="token operator">+</span> y<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">//30</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>栈底----&gt;栈顶：
window--&gt;bar--&gt;foo</p> <h2 id="作用域与作用域链"><a href="#作用域与作用域链" class="header-anchor">#</a> 作用域与作用域链</h2> <ul><li><p>1.理解：</p> <ul><li>就是一块“地盘”，一个代码段所在的区域</li> <li>他是静态的（相对于上下文对象），在编写代码时搞定</li></ul></li> <li><p>2.分类：（个数：n+1个，n为定义了几个函数）</p> <ul><li>全局作用域</li> <li>函数作用域</li> <li>ES6块作用域</li></ul></li> <li><ol start="3"><li>作用:</li></ol> <ul><li>隔离变量，不同作用域下同名变量会有冲突</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>	<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
		<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fn()'</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
			<span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'bar()'</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token function">bar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
		<span class="token function">bar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
	<span class="token comment">/*输出：
	fn() 100 20 300 10
    bar() 1000 20 300 400 100
	bar() 1000 20 300 400 200
	*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><ul><li>4.作用域与执行上下文的区别与联系：
<ul><li>区别一：
<ul><li>全局作用域之外，每个函数都会创建自己的作用域，作用域在函数定义时已经确定了，而不是在函数调用时</li> <li>全局执行上下文环境是在全局作用域确定之后，js代码马上执行之前创建</li> <li>函数执行上下文是在调用函数时，函数体代码执行之前创建</li></ul></li> <li>区别二：
<ul><li>作用域静态的，只要函数定义好了就一直存在，且不会在变化</li> <li>上下文环境是动态的，调用函数时创建，函数调用结束时上下文环境就会被释放</li></ul></li> <li>联系：
<ul><li>上下文环境(对象)是从属于所在的作用域</li> <li>全局上下文环境 ==&gt; 全局作用域</li> <li>函数上下文环境 ==&gt; 对应的函数作用域</li></ul></li></ul></li> <li>5.作用域链：
<ul><li>实例一</li> <li>实例二</li></ul></li> <li>6.面试题：</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">show</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//10</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>解析：
作用域是静态的，并不会因为放在其他函数里里执行而改变作用域的位置；
此处有图</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//f() { console.log(fn)}</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token function-variable function">fn2</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fn2<span class="token punctuation">)</span><span class="token comment">//VM102:8 Uncaught ReferenceError: fn2 is not defined</span>
		<span class="token comment">//console.log(this.fn2) 正确</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
obj<span class="token punctuation">.</span><span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="闭包-closure"><a href="#闭包-closure" class="header-anchor">#</a> 闭包(Closure)</h2> <ul><li>1.如何产生闭包？
<ul><li>当一个嵌套的内部（子）函数引用了嵌套外部（父）函数的变量（函数）时，就产生了闭包。</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">;</span>
	<span class="token keyword">function</span> <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ul><li>2.闭包是什么？
<ul><li>理解1：闭包是嵌套的内部函数</li> <li>理解2：包含被引用变量（函数）的对象</li></ul></li> <li>3.产生闭包的条件：
<ul><li>函数嵌套</li> <li>内部函数引用了外部函数的数据（变量/函数）</li></ul></li> <li>4.作用域应用的特殊情况，有两种表现：
<ul><li>函数作为参数被传递</li> <li>函数作为返回值被返回</li></ul></li> <li>5.所有自由变量的查找，是在<strong>函数定义</strong>的地方，向上级作用域中查找，而不是在执行的地方。</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//表现一：函数作为返回值</span>
<span class="token keyword">function</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token comment">//a为自由变量，在此匿名函数定义域中没有定义，向上层定义域中寻找a=200，找到后停止</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> fn <span class="token operator">=</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">200</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//100，函数执行，a=200在全局作用域，函数定义即a=100在create作用域中</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//函数作为参数被传递</span>
<span class="token keyword">function</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
	<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">100</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">print</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//100,,,,print函数执行的时候是在print函数作用域下，fn()执行时在print作用域里，fn()定义的时候是全局作用域下，里面的a是自由变量，想外层作用域查找定义，即全局作用域的a=100</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ul><li>补充：（来自阮一峰的网络日志http://www.ruanyifeng.com/blog/2009/08/learning_javascript_closures.html）
<ul><li>闭包的概念：能够读取其他函数内部变量的函数；在JS语言中，只有函数内部的子函数才能读取局部变量---&gt;JS中：定义在一个函数内部的函数；本质上，闭包就是将函数内部和外部联系起来的桥梁。</li> <li>用途：
<ul><li>可以读取函数内部的变量</li> <li>让这些变量始终保持在内存中</li></ul></li> <li>使用闭包时需要注意：
<ul><li>由于闭包会使得函数中的变量都被保存在内存中，内存消耗很大，所以不能滥用闭包，否则会造成网页的性能问题，在IE中可能导致内存泄露。解决方法是，在退出函数之前，将不使用的局部变量全部删除。</li> <li>闭包会在父函数外部，改变父函数内部变量的值。所以，如果你把父函数当作对象（object）使用，把闭包当作它的公用方法（Public Method），把内部变量当作它的私有属性（private value），这时一定要小心，不要随便改变父函数内部变量的值。？？？？？？
举个栗子：</li></ul></li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
　　　　<span class="token keyword">var</span> n<span class="token operator">=</span><span class="token number">999</span><span class="token punctuation">;</span>
　　　　<span class="token function-variable function">nAdd</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>n<span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">}</span>
　　　　<span class="token keyword">function</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
　　　　　　<span class="token function">alert</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
　　　　<span class="token punctuation">}</span>
　　　　<span class="token keyword">return</span> f2<span class="token punctuation">;</span>
　　<span class="token punctuation">}</span>
　　<span class="token keyword">var</span> result<span class="token operator">=</span><span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//result是闭包f2函数</span>
　　<span class="token function">result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 999</span>
　　<span class="token function">nAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//就是&quot;nAdd=function(){n+=1}&quot;这一行，首先在nAdd前面没有使用var关键字，因此nAdd是一个全局变量，而不是局部变量。其次，nAdd的值是一个匿名函数（anonymous function），而这个匿名函数本身也是一个闭包，所以nAdd相当于是一个setter，可以在函数外部对函数内部的局部变量进行操作。</span>
　　<span class="token function">result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1000，表明f1局部变量n一直保存在内存中，并没有在f1调用后自动被清除，为什么会这样呢？原因就在于f1是f2的父函数，而f2被赋给了一个全局变量，这导致f2始终在内存中，而f2的存在依赖于f1，因此f1也始终在内存中，不会在调用结束后，被垃圾回收机制（garbage collection）回收。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="promise"><a href="#promise" class="header-anchor">#</a> Promise</h2> <p>ES6引入的异步编程的解决方案，解决“回调地狱”问题</p> <p>语法上看Promise是一个构造函数，可以new一个实例</p> <p>作用：用来封装异步操作并可以获取其成功或失败的结果</p> <ul><li><p>Promise对象有三个状态：</p> <ul><li>初始化</li> <li>成功</li> <li>失败</li></ul></li> <li><p>创建 Promise对象：</p> <ul><li>new Promise(fn)</li> <li>fn = function(resolve,reject) {}</li> <li></li></ul></li> <li><p>Promise.then(function(value){},function(reason){})</p> <ul><li>Promise.then() 里面有两个参数，均为函数，成功就执行第一个函数第一个函数里面形参是成功返回的值，失败执行第二个，第二个是失败返回的值</li> <li>调用then方法，then方法的返回值结果是Promise对象，对象状态由回调函数的执行结果决定；因为如此，then方法可以链式调用；
<ul><li>1）如果回调函数中返回结果是非Promise类型的值，状态为成功（fulfilled），返回值为对象成功的值</li> <li>2）如果返回结果是Promise对象，内部Promise状态就是then方法返回的值</li> <li>3） 如果内部抛出错误，then方法返回值为err值</li></ul></li></ul></li> <li><p>Promise.catch(function(reason){ //错误处理代码 });</p> <ul><li></li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//实例化</span>
<span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//异步操作</span>
	<span class="token comment">//eg:</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token string">&quot;数据库返回数据&quot;</span><span class="token punctuation">;</span>
		<span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//使Promise对象状态为fulfilled，</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="async和await"><a href="#async和await" class="header-anchor">#</a> async和await</h2> <ul><li>async函数：返回值
<ul><li>若返回的结果是 非Promise对象，返回的结果就是成功的Promise对象</li> <li>若抛出错误，返回的结果是一个失败的Promise对象</li> <li>若返回的结果是一个Promise对象，由promise内部返回的值决定</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 	<span class="token comment">//1)返回一个字符串,返回的结果不是一个Promise对象，返回的结果就是成功的Promise对象fulfilled</span>
 	<span class="token comment">//return &quot;lalal&quot;;</span>
 	<span class="token comment">//return; -- PromiseState：fulfilled；PromiseValue:undefined</span>
 	<span class="token comment">//2)抛出错误，返回的结果是一个失败的Promise:</span>
 	<span class="token comment">//throw new Error(&quot;出错&quot;)</span>
 	
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>await函数
<ul><li>await必须写在async函数中（但async函数中可以没有await）</li> <li>await返回Promise对象成功的值</li> <li></li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>	<span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token comment">//resolve(&quot;用户数据&quot;)；</span>
		<span class="token comment">//reject(&quot;失败啦&quot;)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">try</span> <span class="token punctuation">{</span>
			<span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> p<span class="token punctuation">;</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> 
		<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li>async与await结合：
<ul><li>读取文件</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>在这里插入代码片
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>* Ajax请求：
</code></pre></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>在这里插入代码片
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="变量类型"><a href="#变量类型" class="header-anchor">#</a> 变量类型：</h2> <ul><li><strong>1.值类型：</strong> <ul><li>常见值类型：
<ul><li>let a；//undefined类型</li> <li>const s = 'abc'//字符串</li> <li>const n  = 100//数字 number</li> <li>const b = true//布尔 boolen</li> <li>const 是= Symbol('s')//ES6中</li></ul></li> <li>a与b互不影响</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> a<span class="token punctuation">;</span>
a <span class="token operator">=</span> <span class="token number">200</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token comment">//100</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/06c4c88713f9438b96f2d23247ac5ba8.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p> <ul><li><strong>2.引用类型：</strong> <ul><li>const obj = {x : 100} //对象</li> <li>const arr = ['a','b','c'] //数组</li> <li>const n  = null;//特殊引用类型，指针指向为空地址</li> <li>function fn() {};// 特殊引用类型，但不用于存储数据，是一段可执行代码，所以没有“拷贝、复制函数”这一说</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>age：<span class="token number">20</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> a
b<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">21</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>age<span class="token punctuation">)</span> <span class="token comment">//21</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>栈：从上往下
堆：从下往上</p> <p><img src="https://img-blog.csdnimg.cn/a46b627652b447baac917c295aa38d5a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p> <ul><li><strong>3.typeof 运算符</strong> <ul><li>识别所有值类型</li> <li>识别函数</li> <li>判断是否是引用类型（不可在细分）
<img src="https://img-blog.csdnimg.cn/57ecbdda2f2d4d50b437e940945280a5.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/198221194aa14da4953f034ce23b3145.png" alt="在这里插入图片描述"> <img src="https://img-blog.csdnimg.cn/5bb84132778a4dedb74e3e55f3c8a1c5.png" alt="在这里插入图片描述"></li></ul></li> <li><strong>4 手写JS深拷贝</strong></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>
	age<span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">,</span>
	name<span class="token operator">:</span><span class="token string">'XXX'</span><span class="token punctuation">,</span>
	address<span class="token operator">:</span><span class="token punctuation">{</span>
		city<span class="token operator">:</span><span class="token string">'Beijing'</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	arr<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> obj2 <span class="token operator">=</span> obj1<span class="token punctuation">;</span><span class="token comment">//浅拷贝</span>
obj2<span class="token punctuation">.</span>address<span class="token punctuation">.</span>city <span class="token operator">=</span> <span class="token string">&quot;Shanghai&quot;</span>

<span class="token comment">//obj为要拷贝的对象</span>
<span class="token keyword">function</span> <span class="token function">deepClone</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">!==</span> <span class="token string">'object'</span> <span class="token operator">||</span> obj <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// obj是null，或者不是对象和数组，直接返回</span>
		<span class="token keyword">return</span> obj
	<span class="token punctuation">}</span>
	<span class="token comment">//初始化返回结果</span>
	<span class="token keyword">let</span> result<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
		result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	    <span class="token comment">// 保证key不是原型的属性</span>
    	<span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    		<span class="token comment">//递归调用!!!!!处理深层</span>
    		result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
    	<span class="token punctuation">}</span>
    	
    <span class="token punctuation">}</span>
	<span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h2 id="变量计算-类型转换"><a href="#变量计算-类型转换" class="header-anchor">#</a> 变量计算-类型转换</h2> <ul><li><strong>1.字符串拼接</strong></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">//110</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token number">100</span><span class="token operator">+</span> <span class="token string">'10'</span><span class="token punctuation">;</span><span class="token comment">//'110'</span>
<span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token operator">+</span> <span class="token string">'10'</span><span class="token punctuation">;</span><span class="token comment">//'true10'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><strong>2.==运算符</strong> <ul><li>会发生类型转换</li> <li>什么情况下用==？</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//会发生类型转换</span>
<span class="token number">100</span> <span class="token operator">==</span> <span class="token string">'100'</span><span class="token punctuation">;</span><span class="token comment">//true</span>
<span class="token number">0</span> <span class="token operator">==</span> <span class="token string">''</span> <span class="token comment">//true</span>
<span class="token number">0</span> <span class="token operator">==</span> <span class="token boolean">false</span><span class="token comment">//true</span>
<span class="token boolean">false</span> <span class="token operator">==</span><span class="token string">''</span> <span class="token comment">// true</span>
<span class="token keyword">null</span> <span class="token operator">==</span> <span class="token keyword">undefined</span> <span class="token comment">// true</span>

<span class="token comment">//什么情况下用==？除了 == null之外，其他一律用三等（===）</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span>a <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">//相当于：</span>
<span class="token comment">//if (obj.a === null || obj.a === undefined) {}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>- 3.if语句和逻辑运算：</strong>
* truly变量： !!a === true 的变量
* falsely变量： !!a == false 的变量
<img src="https://img-blog.csdnimg.cn/40b47c756a434e68acc9c63952053427.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"> <strong>- 4.逻辑判断：</strong></p> <p><img src="https://img-blog.csdnimg.cn/8d8c80bc69dd462db30ee6e438076c02.png" alt="在这里插入图片描述">
10是truely变量&amp;&amp; 继续判断返回第二个值 0 &amp;&amp; 10 --&gt; 0</p> <p>‘ ’  是falsely变量||继续判断返回第二个值 'abc' || '' --&gt; 'abc'</p> <ul><li><strong>5.面试题</strong>：
<ul><li>typeof能识别什么类型</li> <li>何时用三等 何时用 “==”</li> <li>值类型和引用类型的区别
<img src="https://img-blog.csdnimg.cn/363e569362a24e358c5a1455a726f0ca.png" alt="在这里插入图片描述"></li> <li>手写深拷贝
<ul><li>注意判断值类型和引用类型</li> <li>注意判断数组还是对象</li> <li>递归</li></ul></li></ul></li></ul> <h2 id="原型和原型链"><a href="#原型和原型链" class="header-anchor">#</a> 原型和原型链</h2> <ul><li>如何判断一个变量是不是数组 ？
<ul><li>变量名 instanceof Array</li></ul></li> <li>手写一个简易的jQuery，考虑插件和扩展：</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">jQuery</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> result <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">const</span> length <span class="token operator">=</span> result<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
		<span class="token comment">//将result 复制到 this</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">=</span> length<span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>selector <span class="token operator">=</span> selector<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">get</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//fn方法</span>
	<span class="token function">each</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">const</span> elem <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token function">fn</span><span class="token punctuation">(</span>elem<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//定义type方法名称，fn方法</span>
	<span class="token function">on</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token parameter">elem</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			elem<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span>fn<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//扩展更多DOM api</span>
<span class="token punctuation">}</span>
<span class="token comment">//插件</span>
jQuery<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">dialog</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">alert</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//”造轮子“</span>
<span class="token keyword">class</span> <span class="token class-name">myJQuery</span> <span class="token keyword">extends</span> <span class="token class-name">jQuery</span><span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//扩展自己的方法</span>
	<span class="token function">addClass</span><span class="token punctuation">(</span><span class="token parameter">className</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	
	<span class="token punctuation">}</span>
	<span class="token function">style</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//应用</span>
<span class="token keyword">const</span> $p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">jQuery</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>
$p<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
$p<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token punctuation">(</span>elem<span class="token punctuation">)</span><span class="token operator">=</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>elem<span class="token punctuation">.</span>nodeName<span class="token punctuation">)</span><span class="token punctuation">)</span>
$p<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'clicked'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
$p<span class="token punctuation">.</span><span class="token function">dialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><ul><li>class的原型本质，怎么理解?
<ul><li>原型和原型链图示</li> <li>属性和方法执行的规则</li></ul></li> <li>class和继承</li> <li>类型判断instanceof</li> <li>原型和原型链</li></ul> <p><strong>class：constructor;属性；方法</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//如何用class实现继承</span>
<span class="token comment">//定义一个Student类</span>
<span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">{</span>
	<span class="token comment">//属性,传入参数赋值</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>number <span class="token operator">=</span> number<span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>gender <span class="token operator">=</span> <span class="token string">'male'</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//方法</span>
    <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">姓名 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> , 学号 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>number<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//通过类声明对象/实例</span>
<span class="token keyword">const</span> xialuo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">'xialuo'</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xialuo<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xialuo<span class="token punctuation">.</span>number<span class="token punctuation">)</span>
xialuo<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>继承：extends；super（父类的构建过程）；扩展或重写方法</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//父类，即有公共特性的类</span>
<span class="token keyword">class</span> <span class="token class-name">People</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> eat something</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//子类1,继承了父类</span>
<span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token keyword">extends</span> <span class="token class-name">People</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	    <span class="token comment">//name传递给People的constructor，由他处理 this.name = name</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>number <span class="token operator">=</span> number
	<span class="token punctuation">}</span>
	<span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">姓名 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> , 学号 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>number<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//子类2</span>
<span class="token keyword">class</span> <span class="token class-name">Teacher</span> <span class="token keyword">extends</span> <span class="token class-name">People</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>major</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	    <span class="token comment">//子类将name传递给People的constructor，由他处理 this.name = name</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>major <span class="token operator">=</span> major
	<span class="token punctuation">}</span>
	<span class="token function">teach</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">教授 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>major<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//实例</span>
<span class="token keyword">const</span> xialuo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">'xialuo'</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xialuo<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xialuo<span class="token punctuation">.</span>number<span class="token punctuation">)</span>
xialuo<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
xialuo<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//实例</span>
<span class="token keyword">const</span> laoshi <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Teacher</span><span class="token punctuation">(</span><span class="token string">'王老师'</span>，<span class="token string">'语文'</span><span class="token punctuation">)</span>
laoshi<span class="token punctuation">.</span><span class="token function">teach</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
laoshi1<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p><strong>类型判断-instanceof判断引用类型</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//Student 先继承于People，people默认继承于Object</span>
xialuo <span class="token keyword">instanceof</span> <span class="token class-name">Student</span> <span class="token comment">//true</span>
xialuo <span class="token keyword">instanceof</span> <span class="token class-name">People</span><span class="token comment">//true</span>
xialuo <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token comment">//true</span>

<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">Array</span> <span class="token comment">//true</span>
<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">Object</span> <span class="token comment">//true</span>

<span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">instanceof</span> <span class="token class-name">Object</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>原型</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//class 实际上是函数，可见是语法糖</span>
<span class="token keyword">typeof</span> People<span class="token punctuation">;</span><span class="token comment">//'function'</span>
<span class="token keyword">typeof</span> Student<span class="token punctuation">;</span><span class="token comment">//'function'</span>

<span class="token comment">//隐式原型：</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xialuo<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span>
<span class="token comment">//显式原型</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Student</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xialuo<span class="token punctuation">.</span>__proto__<span class="token operator">===</span> <span class="token class-name">Student</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token comment">//一个内存地址</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/9831633f1b04485c9d6d271cbb67f1b8.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述">
原型关系：</p> <ul><li>每个class都有显式原型prototype</li> <li>每个实例都有隐式原型 <strong>proto</strong></li> <li>实例的__proto__指向对应class的prototype
<img src="https://img-blog.csdnimg.cn/ef628d7f0cde44698beba36f4b062630.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"> <strong>原型链</strong> <img src="https://img-blog.csdnimg.cn/2cbbd6d344944538ac80083b34b8f6d8.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"> <img src="https://img-blog.csdnimg.cn/dd7041699105400fa1d2eea55a237969.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li></ul> <h2 id="作用域和闭包"><a href="#作用域和闭包" class="header-anchor">#</a> 作用域和闭包</h2> <ul><li><p>**作用域：**变量的合法使用范围</p> <ul><li>全局作用域：</li> <li>函数作用域：在函数内部</li> <li>块级作用域：（ES6新增） if，while，for；任何一对花括号中的语句都属于一个快，在这之中的所有变量在代码块外都是不可见的，我们称之为块级作用域
<img src="https://img-blog.csdnimg.cn/c8879a723c3948069e138ddd00173f4a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"> <img src="https://img-blog.csdnimg.cn/aefb15e56ece4afda168d73b2bfaff3d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li></ul></li> <li><p><strong>自由变量：</strong></p> <ul><li>一个变量在当前作用域没有定义，但被使用</li> <li>向上级作用域一层一层依次寻找，知道被找到</li> <li>如果全局作用于都没被找到，则报错xx is not defined</li></ul></li> <li><p><strong>闭包</strong></p> <ul><li>作用域应用的特殊情况：
<ul><li>函数作为参数被传递
<img src="https://img-blog.csdnimg.cn/e08b3093cce544a1bc156076059e857c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_18,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li> <li>函数作为返回值被返回
<img src="https://img-blog.csdnimg.cn/fb9d4d8cb26a42a68c4a41d8b5b0efbc.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_19,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li></ul></li> <li>所有的自由变量的查找，是在<em>函数定义</em>的地方向上级作用域查找，不是在执行的地方！！！！</li> <li>对于闭包的理解：
<ul><li>本质：通过作用域链对自由变量的引用</li> <li>目的：隐藏变量，防止污染作用域</li> <li><strong>使用场景：</strong></li></ul></li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//一个简单的缓存工具</span>
<span class="token comment">//闭包隐藏数据只提供API</span>
<span class="token keyword">function</span> <span class="token function">createCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//闭包中的数据，被隐藏，不被外界访问</span>
	<span class="token keyword">return</span> <span class="token punctuation">{</span>
		<span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			data<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> val<span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token function">createCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
c<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ul><li><strong>this</strong>:取值在<em>函数执行</em>时决定的不是定义时决定
- 作为普通函数
- 使用call apply bind
<img src="https://img-blog.csdnimg.cn/60fa9018f1d749438230c96d49d7e7f9.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"> <ul><li><p>作为对象方法中调用</p></li> <li><p>在class 方法中的使用
<img src="https://img-blog.csdnimg.cn/a276d0e849cd4035a8f4e4bca97fbe4f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p></li> <li><p>箭头函数中的this取值取上级作用域的值
<img src="https://img-blog.csdnimg.cn/d9813f7d89d9473c8ac765496cedc615.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p></li></ul></li> <li><strong>题目：</strong> <ul><li>创建 10个	<code>&lt;a&gt;</code>标签，点击的时候弹出来对应的序号
<ul><li>注意：i的值，如果是全局作用域下的i,那么每次弹出的都是循环的最后一个i</li></ul></li> <li>this 的不同应用场景，如何取值</li> <li>手写bind函数</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//创建 10个	`&lt;a&gt;`标签，点击的时候弹出来对应的序号</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> a<span class="token punctuation">;</span>
	a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	a<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token string">'&lt;br&gt;'</span><span class="token punctuation">;</span>
	a<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>手写bind函数</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//手写bind函数</span>
<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">bind1</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//将参数分解为数组</span>
	<span class="token keyword">const</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//获取 this （数组第一项）</span>
	<span class="token keyword">const</span> t <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//当前fn1.bind(...)中的 fn1</span>
	<span class="token keyword">const</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token comment">//返回一个函数</span>
	<span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token function">self</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>args<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="异步"><a href="#异步" class="header-anchor">#</a> 异步</h2> <ul><li><p>单线程和异步：JS单线程语言；JS和DOM渲染共用一个线程，因为JS可以修改DOM结构</p></li> <li><p>异步和同步区别：异步不会阻塞代码执行，同步会阻塞代码执行</p></li> <li><p>异步应用场景：</p> <ul><li><p>网络请求：eg:ajax图片加载
<img src="https://img-blog.csdnimg.cn/b6722ad38c054d2c850cefa985c651bf.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p></li> <li><p>定时任务，如setTimeout() ,setInterval()</p></li></ul></li> <li><p>Promise基本使用：</p> <ul><li>手写Promise加载图片 ，解决callback hell问题</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> url1<span class="token punctuation">,</span>url2 <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><span class="token comment">//待补充</span>
<span class="token keyword">function</span> <span class="token function">loadImg</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token function">resolve</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		img<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">图片加载失败 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>src<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//触发</span>
		img<span class="token punctuation">.</span>src <span class="token operator">=</span> src
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">loadImg</span><span class="token punctuation">(</span>url1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">img1</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img1<span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//传入第二个then</span>
	<span class="token keyword">return</span> img1<span class="token punctuation">;</span><span class="token comment">//普通对象</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">img1</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img1<span class="token punctuation">.</span>height<span class="token punctuation">)</span>；
	<span class="token keyword">return</span> <span class="token function">loadImg</span><span class="token punctuation">(</span>url2<span class="token punctuation">)</span><span class="token comment">//promise实例</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">img2</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img2<span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> img2<span class="token punctuation">;</span><span class="token comment">//返回上一个then里的img2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">img2</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img2<span class="token punctuation">.</span>height<span class="token punctuation">)</span>；
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">ex</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><ul><li>setTimeout笔试题：
答案：1，3，5，4，2
<img src="https://img-blog.csdnimg.cn/d97dde1dc57d4526b1fc9b288e17b989.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li> <li>一些问题？
<ul><li>什么是回调函数：Js是默认情况下是同步的，是单线程的 ，代码是依次运行的；异步要基于回调来实现；在需要等待的地方，回调函数作为一个值传给另一个函数，并且仅在事件发生时才被执行；
举个栗子：</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//被点击</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>为什么会有回调地狱？由于某些业务问题，在代码中会一次性写多层回调嵌套，缺点：代码耦合，一旦修改，原地爆炸；无法使用try catch，就无法排错，也是原地爆炸</li></ul> <p>举个栗子</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>
<span class="token comment">//有好几个接口需要你使用，然鹅接口A需要接口B的回调res参数去请求数据呢？ 所以就会写成三四个回调函数嵌套。</span>
<span class="token function">ajax1</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">ajax2</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">ajax3</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>解决回调地狱：从 ES6 开始，JavaScript 引入了一些特性，可以帮助处理异步代码而不涉及使用回调：Promise（ES6）和 Async/Await（ES2017）
- Promise：
- async/await</li></ul> <h2 id="异步进阶"><a href="#异步进阶" class="header-anchor">#</a> 异步进阶：</h2> <ul><li>面试题：
<ul><li>问答题
<ul><li>描述event loop (事件循环/事件轮询）的机制</li> <li>什么是宏任务和微任务？两者区别</li> <li>Promise有哪三种状态？如何变化？</li></ul></li> <li>场景题
<ul><li>Promise的then和catch链接
<img src="https://img-blog.csdnimg.cn/ba7b4f155a5c4d08982641e81316318d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li></ul></li> <li>async/await语法<img src="https://img-blog.csdnimg.cn/007f362da67343369d9af36d0f65e8e0.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"></li> <li>promise 和 setTimeout 的顺序<img src="https://img-blog.csdnimg.cn/01fcccc8f49b40a68590ad8b8dbc3c11.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"></li></ul></li> <li><strong>event loop(事件循环/事件轮询)</strong> <ul><li>event loop是异步（setTimeout,ajax）回调的实现原理；DOM事件也使用回调，基于event loop</li> <li>JS 如何执行：从前到后，一行行执行；如果某一行的执行报错，则停止下面的代码的执行；先把同步代码执行完，再执行异步</li> <li>event loop执行过程：
<ul><li>同步代码，一行一行放在Call Stack 执行</li> <li>遇到异步，会先“记录”下，等待时机（定时，网络请求），例如setTimeout执行时会设置一个定时器 timer（WebAPI）</li> <li>时机到了，移动到Callback Queue里面（5s后，cb1放入）</li> <li>如果 Call Stack为空（即同步代码执行完），Event Loop开始工作</li> <li>轮询查找Callback Queue，如有则移动到Call Stack执行</li> <li>然后继续执行轮询查找（永动机一样）
举个栗子：
<img src="https://img-blog.csdnimg.cn/77ae3e4cf6e84be985c3e265350031ae.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"> <img src="https://img-blog.csdnimg.cn/e39dc6b79afe46b3b69f1b212dc96a87.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"></li></ul></li></ul></li> <li><strong>Promise</strong> <ul><li>三个状态：变化不可逆
<ul><li>pending：不会触发then和catch回调</li> <li>resolved:pending-&gt;resolved；会触发then回调函数</li> <li>rejected:pending-&gt;rejected；会触发catch回调函数
<img src="https://img-blog.csdnimg.cn/7f02b235f6a2473aa1096c3df4c22c82.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li></ul></li> <li>then和catch改变状态:
<ul><li>then正常返回resolved，有报错则返回rejected</li> <li>catch正常返回resolved，有报错则返回rejected
catch正常：返回resolved
<img src="https://img-blog.csdnimg.cn/8adbc252ab4040d7ac9f91842f5da6aa.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述">
catch报错：
<img src="https://img-blog.csdnimg.cn/534ec0e8164647a086a2050e31b335ed.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li></ul></li></ul></li> <li>Promise 关于then和catch的面试题：（链式调用）
<ul><li>第一题
<img src="https://img-blog.csdnimg.cn/7a8720060f9a4a0190fb2338ae1e3ab2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_15,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li> <li>第二题
catch没有报错，所以会执行下一个then,整个返回resolved
<img src="https://img-blog.csdnimg.cn/46adaaf49c2345fdbed5a0fca1beeb76.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_18,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li> <li>第三题
第二个catch没有报错，所以返回resolved
<img src="https://img-blog.csdnimg.cn/70327df4395440918e5e11fa35c0ae4f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li></ul></li> <li><strong>async/await</strong> <ul><li>背景：异步回调 callback hell；Promise then catch链式调用，但也是基于回调函数；async/await是同步语法，彻底消灭回调函数</li> <li>与Promise的关系：
<ul><li>执行 async函数，返回的是Promise对象</li> <li>await相当于promise的then</li> <li>try...catch可以捕获异常，代替了Promise的catch</li></ul></li> <li>async/await是promise语法糖
<img src="https://img-blog.csdnimg.cn/cb05e3b2eef34af4a680be757396a096.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"> <img src="https://img-blog.csdnimg.cn/4a395dca45a244ea9e0b1bd314310488.png" alt="在这里插入图片描述">
try...catch可以捕获异常
<img src="https://img-blog.csdnimg.cn/56b81c7fd9ee4e9ebd1e92541439f18e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述">
注意：
res报错，因为await处理不了rejected的情况；如何处理？用上图的try。。。catch。。。
<img src="https://img-blog.csdnimg.cn/2f3a103d57b3408caf31baee89bd38a4.png" alt="在这里插入图片描述"></li></ul></li></ul> <p><img src="https://img-blog.csdnimg.cn/9d432f1a24b24bf6a50d0413087557c1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述">
执行结果为
<img src="https://img-blog.csdnimg.cn/3b3c6ba45451431aa9dee0a8af94a458.png" alt="在这里插入图片描述">
变种：
<img src="https://img-blog.csdnimg.cn/927b2c230c374e49bc86adf529c65ea9.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"> <img src="https://img-blog.csdnimg.cn/82618fb466c748a8ac857ee53614347e.png" alt="请添加图片描述"></p> <p><img src="https://img-blog.csdnimg.cn/48c12c9c80cd45e6be399164ba9afde1.png" alt="在这里插入图片描述"></p> <ul><li><strong>for...of</strong> <ul><li>for ... in（以及 forEach for）是常规的同步遍历</li> <li>for...of 异步遍历</li></ul></li></ul> <p>foreach 隔一秒同时出现1，4，9；forEach 会一次性执行完所有的回调函数
for...of 每隔一秒 1，4，9，一个一个执行
<img src="https://img-blog.csdnimg.cn/31f790e7b36d4ca9a6a89a25c45da393.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p> <ul><li><p>宏任务(macroTask)和微任务(microTask)</p> <ul><li>宏任务：setTimeout,setInterval,Ajax,DOM事件</li> <li>微任务 ：Promise async/await</li> <li>微任务执行时机比宏任务早；</li> <li>*二者区别：*宏任务：DOM渲染后出发，如setTimeout；微任务，DOM渲染前出发，例如Promise</li> <li><em>event loop 和DOM渲染：</em> <ul><li>每次Call Stack清空（即每次轮询结束），即同步任务执行完</li> <li>都是DOM重新渲染的机会，DOM结构如有改变则重新渲染</li> <li>然后再去出发下一次EventLoop
举个栗子<img src="https://img-blog.csdnimg.cn/c080485958134ce1bead4eb03325ff89.png" alt="在这里插入图片描述"> <img src="https://img-blog.csdnimg.cn/8e2b58bedcf441689b9f0632fed1ada7.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li></ul></li> <li>从event loop解释，为何微任务执行更早?
<ul><li>微任务是ES6语法规定的</li> <li>宏任务是由浏览器规定的
<img src="https://img-blog.csdnimg.cn/a6645f6e480241ae9c2ffb9fbe0da7f4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述">
场景题：
1）
<img src="https://img-blog.csdnimg.cn/4b3b5a44c9a44995b11d95cf12425f16.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/77229b7733f94c7789644fbe99deb7a0.png" alt="在这里插入图片描述">
2）start
a 100
b 200
<img src="https://img-blog.csdnimg.cn/5c8db4a3242644ed8dc9c14c2e1cab45.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述">
c 报错，后面的不执行
3）promise和setTimeout的顺序：
100
400
300
200
<img src="https://img-blog.csdnimg.cn/6195b4e55a814341b939023c0f9eea30.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li></ul></li></ul> <p><img src="https://img-blog.csdnimg.cn/17dcb9d461d746c2942b197ca4e62e85.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"> <img src="https://img-blog.csdnimg.cn/40c28de3cc4e4daa8fd8f06b070e5bbd.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p></li></ul> <p>执行结果
<img src="https://img-blog.csdnimg.cn/4f28da1354924a7daa1778f1978e4f75.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_13,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p> <ul><li><strong>手写Promise</strong></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//初始化</span>


<span class="token keyword">const</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyPromise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//处理同步</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//成功后的回调</span>
    <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//失败后的回调</span>
    <span class="token comment">//处理异步；</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//支持链式调用：</span>
<span class="token keyword">const</span> p11 <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> data <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> p12 <span class="token operator">=</span> p1<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> data <span class="token operator">+</span> <span class="token number">2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> p13 <span class="token operator">=</span> p2<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//支持API</span>
<span class="token keyword">const</span> p2 <span class="token operator">=</span> MyPromise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> p3 <span class="token operator">=</span> MyPromise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">&quot;错误信息。。。&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> p4 <span class="token operator">=</span> MyPromise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p1<span class="token punctuation">,</span>p2<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> p5 <span class="token operator">=</span> MyPromise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p1<span class="token punctuation">,</span>p2<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">//构造函数</span>
<span class="token keyword">class</span> <span class="token class-name">MyPromise</span> <span class="token punctuation">{</span>
    state <span class="token operator">=</span> <span class="token string">'pending'</span><span class="token punctuation">;</span><span class="token comment">//状态</span>
    value <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token comment">//成功后的值</span>
    reason <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token comment">//失败后的原因</span>
    resolveCallbacks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment">//当pending状态时，存储成功的回调</span>
    rejectCallbacks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment">//当pending状态时，存储失败的回调</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token function-variable function">resolveHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token string">&quot;pending&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">'fulfilled'</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
                <span class="token comment">//异步</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>resolveCallbacks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">const</span> <span class="token function-variable function">rejectHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token string">&quot;pending&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">'rejected'</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>reason <span class="token operator">=</span> reason<span class="token punctuation">;</span>
                <span class="token comment">//异步</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>rejectCallbacks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>reason<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">fn</span><span class="token punctuation">(</span>resolveHandler<span class="token punctuation">,</span>rejectHandler<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">rejectHandler</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//pending状态时,fn1,fn2会被存储到callback中,状态变化时才执行</span>
    <span class="token comment">//返回新的Promise</span>
    <span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">fn1<span class="token punctuation">,</span>fn2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//判断fn1</span>
        fn1 <span class="token operator">=</span> <span class="token keyword">typeof</span> fn1 <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">?</span> <span class="token function-variable function">fn1</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>v<span class="token punctuation">;</span>
        fn2 <span class="token operator">=</span> <span class="token keyword">typeof</span> fn2 <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">?</span> <span class="token function-variable function">fn2</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>e<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token string">'pending'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>resolveCallbacks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">try</span> <span class="token punctuation">{</span>
                        <span class="token keyword">const</span> newValue <span class="token operator">=</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
                        <span class="token function">resolve</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>rejectCallbacks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">try</span> <span class="token punctuation">{</span>
                        <span class="token keyword">const</span> newReason <span class="token operator">=</span> <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>reason<span class="token punctuation">)</span>
                        <span class="token function">reject</span><span class="token punctuation">(</span>newReason<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> p1<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token string">'fulfilled'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token keyword">const</span> newValue <span class="token operator">=</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
                    <span class="token function">resolve</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token comment">//返回新的promise</span>
            <span class="token keyword">return</span> p1
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token string">'rejected'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyPromise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token keyword">const</span> newReason <span class="token operator">=</span> <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>reason<span class="token punctuation">)</span>
                    <span class="token function">reject</span><span class="token punctuation">(</span>newReason<span class="token punctuation">)</span> <span class="token comment">//p1.reason</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> p1
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//then的一个语法糖，简单模式</span>
    <span class="token keyword">catch</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span>fn<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

MyPromise<span class="token punctuation">.</span><span class="token function-variable function">resolve</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
MyPromise<span class="token punctuation">.</span><span class="token function-variable function">reject</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//传入Promise数组，等待所有的都fulfilled后，返回新的Promise</span>
MyPromise<span class="token punctuation">.</span><span class="token function-variable function">all</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">promiseList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyPromise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//存储promiseList所有结果</span>
        <span class="token keyword">const</span> length <span class="token operator">=</span> promiseList<span class="token punctuation">.</span>length
        <span class="token keyword">let</span> resolvedCount <span class="token operator">=</span> <span class="token number">0</span>
        promiseList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">p</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//resolvedCount必须的在then里面做++</span>
                <span class="token comment">//不能用index</span>
                resolvedCount<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>resolvedCount <span class="token operator">===</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">//已经遍历到了最后一个Promise</span>
                    <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//传入Promise数组，只要有一个fulfilled</span>
MyPromise<span class="token punctuation">.</span><span class="token function-variable function">race</span><span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">promiseList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> resolved <span class="token operator">=</span><span class="token boolean">false</span><span class="token comment">//标记</span>
    <span class="token keyword">const</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        promiseList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">p</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>resolved<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    resolved <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> p1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br></div></div><h2 id="js-web-api-dom"><a href="#js-web-api-dom" class="header-anchor">#</a> Js-Web-API-DOM</h2> <ul><li>DOM:（Document Object Model）网页DOm元素，例如文本
<ul><li>面试题：
<ul><li>DOM属于哪种数据结构 ：树（DOM树）</li> <li>Dom操作的常用API：DOM节点操作，DOM结构操作</li> <li>attr和property区别：property：修改对象属性，不会体现在html结构中；attribute：修改html属性，会改变html结构；两者都可能引起DOM重新渲染</li> <li>一次性插入多个DOM节点，</li></ul></li> <li>DOM本质：</li> <li>DOM节点操作：
<ul><li>获取DOM节点：
![在这里插入图片描述](https://img-blog.csdnimg.cn/a6f842064c2242c4970cdfbf3134ea7d.png?x-oss-process=image/watermar<img src="https://img-blog.csdnimg.cn/bdf95f156b1d4d3f97f58d293a345ba1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"> <img src="https://img-blog.csdnimg.cn/3eaaaaee39ad435d920ed0423b81b765.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li></ul></li></ul></li> <li>DOM节点的property，修改对象，不会体现到html结构中
property属性属于DOM对象，DOM实质就是javascript中的对象。我们可以跟在js中操作普通对象一样获取、设置DOM对象的属性，并且property属性可以是任意类型。
<img src="https://img-blog.csdnimg.cn/8e02cc55ac804de8a6fbfa82e7ab83b6.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述">
普通的dom节点nodeType = 1</li> <li>DOM节点的attribute，会改变html结构
由HTML定义，所有出现在HTML标签内的描述节点都是attribute特性。
<img src="https://img-blog.csdnimg.cn/c3498fdf875443cc87e7129ed4217e52.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li> <li>DOM结构操作
<ul><li>新增/插入节点</li></ul></li></ul> <p><img src="https://img-blog.csdnimg.cn/cec6c069980c4cc8940c89b87505eb59.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"></p> <ul><li>父节点，子元素列表</li></ul> <p><img src="https://img-blog.csdnimg.cn/fffc88f659704c65a07183e907dee7e7.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p> <ul><li>删除节点
<img src="https://img-blog.csdnimg.cn/2aff1342625549ed86cd8a2ebed7e119.png" alt="请添加图片描述"></li> <li>DOM性能
<ul><li><p>DOM操作非常“昂贵”，避免频繁的DOM操作</p></li> <li><p>对DOM查询做缓存
<img src="https://img-blog.csdnimg.cn/e3dc87394e1d47af94ea38c486854341.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p></li> <li><p>将频繁操作改为一次性操作
<img src="https://img-blog.csdnimg.cn/745d91ba246b4925884769a201bda8ec.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p></li></ul></li></ul> <h2 id="js-web-api-bom"><a href="#js-web-api-bom" class="header-anchor">#</a> Js-Web-API-BOM</h2> <ul><li>BOM(Browser Object Model)
<ul><li>问题
<ul><li>如何识别浏览器类型：</li> <li>分析分解url各个部分</li></ul></li> <li>navigator:
<img src="https://img-blog.csdnimg.cn/f937979ddf23495ba05e4f72ca27239c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li> <li>screen:
<img src="https://img-blog.csdnimg.cn/77198ba36d134d05a194c88070df35f7.png" alt="在这里插入图片描述"></li> <li>location和history
<img src="https://img-blog.csdnimg.cn/e30c72d5093449d8ac7baef905a31011.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li></ul></li></ul> <h2 id="js-web-api-事件"><a href="#js-web-api-事件" class="header-anchor">#</a> JS-web-API-事件</h2> <ul><li>事件绑定
<img src="https://img-blog.csdnimg.cn/4ad7d72477b141cba350db9124c70644.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"> <img src="https://img-blog.csdnimg.cn/1fd2bac885ae4535b8a5bc45cc8d483e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li> <li>事件冒泡</li></ul> <p><img src="https://img-blog.csdnimg.cn/2cbf09a97caa4e7d863e3e15c0d74e56.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p> <ul><li>事件代理
<ul><li>事件委托就是利用事件冒泡，只指定一个事件处理程序，就可以管理某一类型的所有事件。</li> <li>代码简洁</li> <li>减少浏览器内存使用，但是不要滥用</li></ul></li> <li>编写一个通用的事件监听函数
<img src="https://img-blog.csdnimg.cn/ccdbc0e588614e7cb8735b97a017f60a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li> <li>描述事件冒泡的流程
<ul><li>基于DOM树形结构</li> <li>事件会顺着出发元素向上冒泡</li> <li>应用场景：代理</li></ul></li> <li>无限下拉图片列表，如何坚挺每个图片的点击
<ul><li>事件代理</li> <li>用e.target获取触发元素</li> <li>用matches来判断是否触发元素</li></ul></li></ul> <h2 id="js-web-api-ajax"><a href="#js-web-api-ajax" class="header-anchor">#</a> JS-web-API-ajax</h2> <ul><li>XMLHttpRequest
GET：
<img src="https://img-blog.csdnimg.cn/93ce0c6e2f2f40f8ae4fb5166d4678ac.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li></ul> <p>POST：
<img src="https://img-blog.csdnimg.cn/c5e1755d34cb4f4a850a70e390c6bcf0.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p> <ul><li><p>xhr.readyState</p> <ul><li>0（未初始化）还没有调用send()方法</li> <li>1（载入）已经调用send()方法，正在发送请求</li> <li>2（载入完成）send()方法执行完成，已经收到全部响应内容</li> <li>3（交互）正在解析响应内容</li> <li>4（完成）响应内容解析完成，可以在客户端调用</li></ul></li> <li><p>xhr.status:</p> <ul><li>2**-表示成功处理请求，如200</li> <li>3**重定向，浏览器直接跳转，如301（永久重定向），302（临时重定向），304（资源未改变，用缓存的资源）</li> <li>4**客户端请求错误，如404c403，（内部没有权限）</li> <li>5** 服务端错误</li></ul></li> <li><p>跨域：同源策略，同源解决方案</p> <ul><li>同源策略：ajax请求时，浏览器要求当前网页和server必须同源（安全）</li> <li>同源：协议，域名，端口，三者必须一致</li> <li>加载图片 css js可无视同源策略
<img src="https://img-blog.csdnimg.cn/5eb51abe15284888b87b4ee5c472928f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"> <img src="https://img-blog.csdnimg.cn/97685f95352d42a789b6e30c323cddb0.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li> <li>跨域：
<ul><li>所有跨域，都必须通过server端允许和配合</li> <li>未经server端允许就实现跨域，说明浏览器有漏洞，危险信号</li></ul></li> <li>实现跨域常见方式：
<ul><li>jsonp：
<img src="https://img-blog.csdnimg.cn/9a6ca94cd6a844fe96e5249ceb5813f6.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"> <img src="https://img-blog.csdnimg.cn/16571714e0974b86bc317016f6113f30.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li></ul></li></ul></li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
		window<span class="token punctuation">.</span><span class="token function-variable function">abc</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">&quot;</span>http://localhost:8002/jsonp.js?username=xxx&amp;callback=abc<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
	</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//jsonp.js</span>
<span class="token comment">//callback=abc知道客户端有abc函数</span>
<span class="token function">abc</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	name<span class="token operator">:</span><span class="token string">'xxx'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>CORS
<img src="https://img-blog.csdnimg.cn/d87ada00c80440909fa7a75b1bc36d80.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="请添加图片描述"></li> <li>题目：
<ul><li>手写一个简易的ajax：
<img src="https://img-blog.csdnimg.cn/dff85266745d42389b8b1ed41c1feb8c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li></ul></li> <li>跨域：
<ul><li>jsonp</li> <li>CORS</li></ul></li> <li>ajax常用插件：
<ul><li>jQuery</li> <li>fetch</li> <li>axios</li></ul></li></ul> <h2 id="存储"><a href="#存储" class="header-anchor">#</a> 存储</h2> <ul><li>cookie缺点：<img src="https://img-blog.csdnimg.cn/895e8ce5a74b4587a59e352dfb4cedac.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li> <li>localStorage 和 sessionStorage
<img src="https://img-blog.csdnimg.cn/1675a1d7cc374fb784b75d3eb5cf5517.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="">
二者区别：
<img src="https://img-blog.csdnimg.cn/9d1644b401ae4338ba5f28c3a1e0e050.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"> <img src="https://img-blog.csdnimg.cn/fc340969c7ae4de599bb2a1217f10bbe.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li></ul> <h2 id="http面试题"><a href="#http面试题" class="header-anchor">#</a> http面试题</h2> <ul><li><p>http状态码</p> <ul><li>状态码分类
<ul><li>1XX服务器收到请求</li> <li>2XX请求成功，如200</li> <li>3XX重定向，如302</li> <li>4XX客户端错误，如404</li> <li>5XX服务端错误，如500</li></ul></li> <li>常见状态码：
<ul><li>200 成功</li> <li>301 永久重定向（配合location，浏览器自动处理）</li> <li>302 临时重定向（配合location，浏览器自动处理）</li> <li>304 资源未被修改：</li> <li>404 资源未找到</li> <li>403 没有权限</li> <li>500服务器错误</li> <li>504 网关超时</li></ul></li> <li>http的methods：
<ul><li>传统的methods：
<ul><li>get 获取服务器数据</li> <li>post向服务器提交数据</li></ul></li> <li>现在的methods：
<ul><li>get获取数据</li> <li>post新建数据</li> <li>patch/put 更新数据</li> <li>delete删除数据</li></ul></li> <li>Restful API
<ul><li>传统的API设计：把每个url当作一个功能</li> <li>Restful API设计：把每个url当作一个唯一的资源
<ul><li>不使用url参数：
<img src="https://img-blog.csdnimg.cn/f8ada90fd33b471ab0b8260805d3ca9f.png" alt="在这里插入图片描述"></li> <li>使用method表示操作类型
<img src="https://img-blog.csdnimg.cn/b8e2c9afe2954e76bdff594872065933.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li></ul></li></ul></li></ul></li></ul></li> <li><p>http headers：</p> <ul><li><p>常见的request headers
<img src="https://img-blog.csdnimg.cn/7a9480f21eef411dad947418d662bda5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"> <img src="https://img-blog.csdnimg.cn/81cbe9461c4049348b1ec17fd9d51b4b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"> <img src="https://img-blog.csdnimg.cn/5f07cdf8d5474fb2b9c63d82246b134d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p></li> <li><p>response headers
<img src="https://img-blog.csdnimg.cn/a51ee5b5c3ec412ca85f080317661016.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"> <img src="https://img-blog.csdnimg.cn/cd05fedadc36446dbc7803cf1f7bc4ff.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p></li> <li><p>自定义header</p></li></ul></li> <li><p>http缓存</p> <ul><li>什么是缓存？</li> <li>为什么要缓存？减少网络请求的数量与体积，让页面加载更快</li> <li>哪些资源可以被缓存：静态资源（js，css，img）</li> <li>强制缓存：
<img src="https://img-blog.csdnimg.cn/060f387591e24beaa09399098adbb457.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></li> <li>cache-control的值
<ul><li>max-age：缓存最大时间</li> <li>no-cache：不用本地缓存，去服务端请求，不管服务端如何处理</li> <li>no-store：不用强制缓存，不用服务端的缓存措施</li> <li>private：允许最终用户缓存</li> <li>public允许路由缓存</li></ul></li> <li>关于 expires
<ul><li>同在response headers中</li> <li>同为控制缓存过期</li> <li>已被cache-control代替</li></ul></li> <li>协商缓存：
<ul><li>服务端缓存策略：服务端判断一个资源是否可以被缓存：</li> <li>服务端判断客户端资源，是否和服务端资源一样</li> <li>一致则返回304（资源未被修改），否则返回200和最新资源
<ul><li><h2 id="资源标识"><a href="#资源标识" class="header-anchor">#</a> 资源标识：</h2></li></ul></li></ul></li></ul> <p><img src="https://img-blog.csdnimg.cn/9d83259bf94f4b6d99ec33a55140893e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qyjTW9vbg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p></li></ul> <h2 id="运行环境"><a href="#运行环境" class="header-anchor">#</a> 运行环境</h2> <ul><li><p>运行环境即浏览器（server 端游node.js）</p></li> <li><p>下载网页代码，渲染出页面，期间会执行若干js</p></li> <li><p>从输入url到显示出网页整个过程：</p> <ul><li>下载资源：各个资源类型(html代码，媒体文件，如文件。视频；js,css)</li> <li>加载过程
<ul><li>DNS解析：域名-&gt; IP地址</li> <li>浏览器根据IP地址向服务器发起http请求</li> <li>服务器处理http请求，并返回浏览器</li></ul></li> <li>渲染过程：
<ul><li>根据HTML代码生成DOM Tree</li> <li>根据CSS代码生成CSSOM</li> <li>将DOM Tree和CSSOM整个形成Render Tree</li> <li>根据Render Tree渲染界面</li> <li>遇到<script></script></li></ul></li></ul></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/web/js/" class="prev router-link-active">
        目录
      </a></span> <span class="next"><a href="/web/nodejs/">
        目录
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4bd64760.js" defer></script><script src="/assets/js/2.cae01b08.js" defer></script><script src="/assets/js/20.f36be1a4.js" defer></script>
  </body>
</html>
